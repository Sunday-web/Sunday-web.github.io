<!DOCTYPE html>
<html lang="zh">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>pm2.5</title>
  <link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
  <link rel="shortcut icon" href="https://assets-cdn.github.com/favicon.ico">
  <link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <style>
 
  </style>
</head>

<body>

  <div class="container">
    <div id="search">查询</div>
  </div>

</body>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script>
  //pm2.5
  //5j1znBVAsnSf5xQyNQyq
  $('#search').click(function () {
    //$('.result').empty();
    //$('.loading').show();
    //var data = $('#inputDate').val();
    var getUrl = 'http://www.pm25.in/api/querys/pm2_5.json?city=shenzhen&token=5j1znBVAsnSf5xQyNQyq';
    $.ajax({
      type: "GET",
      url: getUrl,
      dataType: "jsonp",
      success: function (res) { //成功的回调函数
        console.log(res);
        if (res.code == 0) { //返回成功
          //$('.loading').hide();
          //setdata(res);
        } else { //返回失败
          console.log('');
        }
      }
    });
  });

  function setdata(res) {
    //console.log(res);
    var data = res.data;
    var list = '';
    for (var k in data) {
      this.data = data[k];
      this.movie_name = this.data.movie_name; //片名
      this.duration = this.data.duration ? this.data.duration : '未上映'; //时间
      this.totle_office = this.data.totle_office; //总票房
      this.real_office = this.data.real_office; //实时票房(万元)
      this.office_ratio = this.data.office_ratio; //票房占比
      this.show_rate = this.data.show_rate; //排片占比
      this.avg_seat_view = this.data.avg_seat_view; //上座率
      list += '<div class="col-sm-6 col-md-4">' +
        '<div class="thumbnail" style="font-size: 18px;">' +
        '<p>片名：' + this.movie_name + '</p>' +
        '<p>时间：' + this.duration + '</p>' +
        '<p>总票房：' + this.totle_office + '</p>' +
        // '<p>实时票房：' + this.totle_office + '</p>' +
        '<div>'+
          '<span>票房占比：</span>' +
          '<div class="progress">' +
            '<div class="progress-bar progress-bar-danger progress-bar-striped active" role="progressbar" aria-valuenow="2" aria-valuemin="0" aria-valuemax="100" style="min-width: 2em; width: '+ this.office_ratio+';">' +
              ''+this.office_ratio+'' +
              '</div>' +
          '</div>' +
        '</div>' +
        '<div>' +
        '<span>排片占比：</span>' +
        '<div class="progress">' +
        '<div class="progress-bar progress-bar-danger progress-bar-striped active" role="progressbar" aria-valuenow="2" aria-valuemin="0" aria-valuemax="100" style="min-width: 2em; width: ' + this.office_ratio + ';">' +
        '' + this.show_rate + '' +
        '</div>' +
        '</div>' +
        '</div>' +

        '<div>' +
        '<span>上座率：</span>' +
        '<div class="progress">' +
        '<div class="progress-bar progress-bar-danger progress-bar-striped active" role="progressbar" aria-valuenow="2" aria-valuemin="0" aria-valuemax="100" style="min-width: 2em; width: ' + this.office_ratio + ';">' +
        '' + this.avg_seat_view + '' +
        '</div>' +
        '</div>' +
        '</div>' +
    
        '</div>' +
        '</div>';
    }
    $('.result').append(list);
  }
</script>

</html>